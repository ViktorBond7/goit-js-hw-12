{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst searchFormRes = document.querySelector('.form');\nconst imageGalleryRes = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtnRes = document.querySelector(\n  'button[data-action=\"load-more\"]'\n);\nconst searchInput = document.querySelector('.search-input');\n\nloader.style.display = 'none';\n\nlet currentPage = 1;\nconst perPage = 3;\nlet searchQuery = '';\n\nconst styleRef = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captionDelay: 250,\n  captionsData: 'alt',\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nasync function fetchImg(query) {\n  searchQuery = query;\n  const searchParams = {\n    key: '41712066-bd7b5e249df7a86bd45ef70ea',\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: currentPage,\n    per_page: perPage,\n  };\n  const params = new URLSearchParams(searchParams);\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n    iziToast.error({\n      position: 'topRight',\n      width: '10px',\n      message:\n        'Sorry, there are no images matching your search query. Please try again',\n    });\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nfunction rendersImg(data) {\n  if (data.hits.length > 0) {\n    const imgs = data.hits.reduce(\n      (\n        html,\n        { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n      ) =>\n        html +\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n           <img class=\"gallery-image\"\n           src=\"${webformatURL}\"\n           alt=\"${tags}\"\n           />\n          </a>\n          <div class=\"description\">\n          <p><b>Likes</b>${likes}</p>\n          <p><b>Views</b>${views}</p>\n          <p><b>Comments</b>${comments}</p>\n          <p><b>Downloads</b>${downloads}</p>\n          </div>\n        </li>`,\n      ''\n    );\n    imageGalleryRes.insertAdjacentHTML('beforeend', imgs);\n    styleRef.refresh();\n  } else {\n    loadMoreBtnRes.style.display = 'none';\n    iziToast.error({\n      position: 'topRight',\n      width: '10px',\n      message:\n        'Sorry, there are no images matching your search query. Please try again',\n    });\n  }\n}\n\nsearchFormRes.addEventListener('submit', async e => {\n  e.preventDefault();\n  loadMoreBtnRes.style.display = 'none';\n  imageGalleryRes.innerHTML = '';\n  loader.style.display = 'block';\n  currentPage = 1;\n\n  const query = searchInput.value.trim();\n  const fetchImgs = await fetchImg(query, currentPage);\n  rendersImg(fetchImgs);\n  if (fetchImgs > 0) {\n    loadMoreBtnRes.style.display = 'block';\n  }\n  e.target.reset();\n});\n\nconst scrollToNextGroup = () => {\n  const firstGalleryItem = document.querySelector('.gallery-item:first-child');\n  const galleryItemHeight = firstGalleryItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nloadMoreBtnRes.addEventListener('click', async () => {\n  loadMoreBtnRes.style.display = 'none';\n  const { totalHits } = await fetchImg(searchQuery, currentPage, perPage);\n\n  loader.style.display = 'block';\n  if (currentPage * perPage >= totalHits) {\n    iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n  } else {\n    currentPage += 1;\n    const fetcImgRen = await fetchImg(searchQuery, currentPage);\n    rendersImg(fetcImgRen);\n    loadMoreBtnRes.style.display = 'block';\n    scrollToNextGroup();\n  }\n});\n"],"names":["searchFormRes","imageGalleryRes","loader","loadMoreBtnRes","searchInput","currentPage","perPage","searchQuery","styleRef","SimpleLightbox","fetchImg","query","searchParams","params","axios","error","iziToast","rendersImg","data","imgs","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","e","fetchImgs","scrollToNextGroup","galleryItemHeight","totalHits","fetcImgRen"],"mappings":"owBAMA,MAAMA,EAAgB,SAAS,cAAc,OAAO,EAC9CC,EAAkB,SAAS,cAAc,UAAU,EACnDC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAC9B,iCACF,EACMC,EAAc,SAAS,cAAc,eAAe,EAE1DF,EAAO,MAAM,QAAU,OAEvB,IAAIG,EAAc,EAClB,MAAMC,EAAU,EAChB,IAAIC,EAAc,GAElB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,IAAK,GACL,aAAc,IACd,aAAc,MACd,MAAO,GACP,eAAgB,GAChB,SAAU,EACZ,CAAC,EAED,eAAeC,EAASC,EAAO,CAC7BJ,EAAcI,EACd,MAAMC,EAAe,CACnB,IAAK,qCACL,EAAGL,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMF,EACN,SAAUC,CACd,EACQO,EAAS,IAAI,gBAAgBD,CAAY,EAC/C,GAAI,CAEF,OADiB,MAAME,EAAM,IAAI,4BAA4BD,GAAQ,GACrD,IACjB,OAAQE,EAAP,CACA,QAAQ,MAAMA,CAAK,EACnBC,EAAS,MAAM,CACb,SAAU,WACV,MAAO,OACP,QACE,yEACR,CAAK,CACL,QAAY,CACRd,EAAO,MAAM,QAAU,MACxB,CACH,CAEA,SAASe,EAAWC,EAAM,CACxB,GAAIA,EAAK,KAAK,OAAS,EAAG,CACxB,MAAMC,EAAOD,EAAK,KAAK,OACrB,CACEE,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAExEP,EACA;AAAA,0CACkCE;AAAA;AAAA,kBAExBD;AAAA,kBACAE;AAAA;AAAA;AAAA;AAAA,2BAISC;AAAA,2BACAC;AAAA,8BACGC;AAAA,+BACCC;AAAA;AAAA,eAGzB,EACN,EACI1B,EAAgB,mBAAmB,YAAakB,CAAI,EACpDX,EAAS,QAAO,CACpB,MACIL,EAAe,MAAM,QAAU,OAC/Ba,EAAS,MAAM,CACb,SAAU,WACV,MAAO,OACP,QACE,yEACR,CAAK,CAEL,CAEAhB,EAAc,iBAAiB,SAAU,MAAM4B,GAAK,CAClDA,EAAE,eAAc,EAChBzB,EAAe,MAAM,QAAU,OAC/BF,EAAgB,UAAY,GAC5BC,EAAO,MAAM,QAAU,QACvBG,EAAc,EAEd,MAAMM,EAAQP,EAAY,MAAM,KAAI,EAC9ByB,EAAY,MAAMnB,EAASC,CAAkB,EACnDM,EAAWY,CAAS,EAChBA,EAAY,IACd1B,EAAe,MAAM,QAAU,SAEjCyB,EAAE,OAAO,OACX,CAAC,EAED,MAAME,EAAoB,IAAM,CAE9B,MAAMC,EADmB,SAAS,cAAc,2BAA2B,EAChC,sBAAqB,EAAG,OACnE,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QACd,CAAG,CACH,EAEA5B,EAAe,iBAAiB,QAAS,SAAY,CACnDA,EAAe,MAAM,QAAU,OAC/B,KAAM,CAAE,UAAA6B,CAAW,EAAG,MAAMtB,EAASH,CAAiC,EAGtE,GADAL,EAAO,MAAM,QAAU,QACnBG,EAAcC,GAAW0B,EAC3BhB,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACf,CAAK,MACI,CACLX,GAAe,EACf,MAAM4B,EAAa,MAAMvB,EAASH,CAAwB,EAC1DU,EAAWgB,CAAU,EACrB9B,EAAe,MAAM,QAAU,QAC/B2B,GACD,CACH,CAAC"}