{"version":3,"file":"commonHelpers.js","sources":["../src/main.js"],"sourcesContent":["import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\nimport axios from 'axios';\n\nconst formRes = document.querySelector('.form');\nconst galleryRes = document.querySelector('.gallery');\nconst loader = document.querySelector('.loader');\nconst loadMoreBtnRes = document.querySelector(\n  'button[data-action=\"load-more\"]'\n);\nconst searchInput = document.querySelector('.search-input');\n\nloader.style.display = 'none';\n\nloadMoreBtnRes.style.display = 'none';\n\nlet pageA = 1;\nlet perPage = 40;\nlet searchQuery = '';\n\nconst styleRef = new SimpleLightbox('.gallery a', {\n  nav: true,\n  captionDelay: 250,\n  captionsData: 'alt',\n  close: true,\n  enableKeyboard: true,\n  docClose: true,\n});\n\nasync function fetchImg(query) {\n  searchQuery = query;\n  const searchParams = {\n    key: '41712066-bd7b5e249df7a86bd45ef70ea',\n    q: searchQuery,\n    image_type: 'photo',\n    orientation: 'horizontal',\n    safesearch: true,\n    page: pageA,\n    per_page: perPage,\n  };\n  const params = new URLSearchParams(searchParams);\n  try {\n    const response = await axios.get(`https://pixabay.com/api/?${params}`);\n    return response.data;\n  } catch (error) {\n    console.error(error);\n  } finally {\n    loader.style.display = 'none';\n  }\n}\n\nfunction rendersImg(data) {\n  if (data.hits.length > 0) {\n    const imgs = data.hits.reduce(\n      (\n        html,\n        { webformatURL, largeImageURL, tags, likes, views, comments, downloads }\n      ) =>\n        html +\n        `<li class=\"gallery-item\">\n          <a class=\"gallery-link\" href=\"${largeImageURL}\">\n           <img class=\"gallery-image\"\n           src=\"${webformatURL}\"\n           alt=\"${tags}\"\n           />\n          </a>\n          <div class=\"description\">\n          <p><b>Likes</b>${likes}</p>\n          <p><b>Views</b>${views}</p>\n          <p><b>Comments</b>${comments}</p>\n          <p><b>Downloads</b>${downloads}</p>\n          </div>\n        </li>`,\n      ''\n    );\n    galleryRes.insertAdjacentHTML('beforeend', imgs);\n    styleRef.refresh();\n    loadMoreBtnRes.style.display = 'block';\n  } else {\n    loadMoreBtnRes.style.display = 'none';\n    iziToast.error({\n      position: 'topRight',\n      width: '10px',\n      message:\n        'Sorry, there are no images matching your search query. Please try again',\n    });\n  }\n}\n\nformRes.addEventListener('submit', async e => {\n  e.preventDefault();\n\n  galleryRes.innerHTML = '';\n  loader.style.display = 'block';\n  pageA = 1;\n\n  const query = searchInput.value.trim();\n  const fetchImgs = await fetchImg(query, pageA);\n  rendersImg(fetchImgs);\n  e.target.reset();\n});\n\nconst scrollToNextGroup = () => {\n  const firstGalleryItem = document.querySelector('.gallery-item:first-child');\n  const galleryItemHeight = firstGalleryItem.getBoundingClientRect().height;\n  window.scrollBy({\n    top: galleryItemHeight * 2,\n    behavior: 'smooth',\n  });\n};\n\nloadMoreBtnRes.addEventListener('click', async () => {\n  const { totalHits } = await fetchImg(searchQuery, pageA, perPage);\n\n  if (pageA * perPage >= totalHits) {\n    iziToast.info({\n      position: 'topRight',\n      message: \"We're sorry, but you've reached the end of search results.\",\n    });\n    loadMoreBtnRes.style.display = 'none';\n  } else {\n    loadMoreBtnRes.style.display = 'flex';\n    pageA += 1;\n    const fetcImgRen = await fetchImg(searchQuery, pageA);\n    rendersImg(fetcImgRen);\n    scrollToNextGroup();\n  }\n});\n"],"names":["formRes","galleryRes","loader","loadMoreBtnRes","searchInput","pageA","perPage","searchQuery","styleRef","SimpleLightbox","fetchImg","query","searchParams","params","axios","error","rendersImg","data","imgs","html","webformatURL","largeImageURL","tags","likes","views","comments","downloads","iziToast","e","fetchImgs","scrollToNextGroup","galleryItemHeight","totalHits","fetcImgRen"],"mappings":"owBAMA,MAAMA,EAAU,SAAS,cAAc,OAAO,EACxCC,EAAa,SAAS,cAAc,UAAU,EAC9CC,EAAS,SAAS,cAAc,SAAS,EACzCC,EAAiB,SAAS,cAC9B,iCACF,EACMC,EAAc,SAAS,cAAc,eAAe,EAE1DF,EAAO,MAAM,QAAU,OAEvBC,EAAe,MAAM,QAAU,OAE/B,IAAIE,EAAQ,EACRC,EAAU,GACVC,EAAc,GAElB,MAAMC,EAAW,IAAIC,EAAe,aAAc,CAChD,IAAK,GACL,aAAc,IACd,aAAc,MACd,MAAO,GACP,eAAgB,GAChB,SAAU,EACZ,CAAC,EAED,eAAeC,EAASC,EAAO,CAC7BJ,EAAcI,EACd,MAAMC,EAAe,CACnB,IAAK,qCACL,EAAGL,EACH,WAAY,QACZ,YAAa,aACb,WAAY,GACZ,KAAMF,EACN,SAAUC,CACd,EACQO,EAAS,IAAI,gBAAgBD,CAAY,EAC/C,GAAI,CAEF,OADiB,MAAME,EAAM,IAAI,4BAA4BD,GAAQ,GACrD,IACjB,OAAQE,EAAP,CACA,QAAQ,MAAMA,CAAK,CACvB,QAAY,CACRb,EAAO,MAAM,QAAU,MACxB,CACH,CAEA,SAASc,EAAWC,EAAM,CACxB,GAAIA,EAAK,KAAK,OAAS,EAAG,CACxB,MAAMC,EAAOD,EAAK,KAAK,OACrB,CACEE,EACA,CAAE,aAAAC,EAAc,cAAAC,EAAe,KAAAC,EAAM,MAAAC,EAAO,MAAAC,EAAO,SAAAC,EAAU,UAAAC,CAAW,IAExEP,EACA;AAAA,0CACkCE;AAAA;AAAA,kBAExBD;AAAA,kBACAE;AAAA;AAAA;AAAA;AAAA,2BAISC;AAAA,2BACAC;AAAA,8BACGC;AAAA,+BACCC;AAAA;AAAA,eAGzB,EACN,EACIzB,EAAW,mBAAmB,YAAaiB,CAAI,EAC/CV,EAAS,QAAO,EAChBL,EAAe,MAAM,QAAU,OACnC,MACIA,EAAe,MAAM,QAAU,OAC/BwB,EAAS,MAAM,CACb,SAAU,WACV,MAAO,OACP,QACE,yEACR,CAAK,CAEL,CAEA3B,EAAQ,iBAAiB,SAAU,MAAM4B,GAAK,CAC5CA,EAAE,eAAc,EAEhB3B,EAAW,UAAY,GACvBC,EAAO,MAAM,QAAU,QACvBG,EAAQ,EAER,MAAMM,EAAQP,EAAY,MAAM,KAAI,EAC9ByB,EAAY,MAAMnB,EAASC,CAAY,EAC7CK,EAAWa,CAAS,EACpBD,EAAE,OAAO,OACX,CAAC,EAED,MAAME,EAAoB,IAAM,CAE9B,MAAMC,EADmB,SAAS,cAAc,2BAA2B,EAChC,sBAAqB,EAAG,OACnE,OAAO,SAAS,CACd,IAAKA,EAAoB,EACzB,SAAU,QACd,CAAG,CACH,EAEA5B,EAAe,iBAAiB,QAAS,SAAY,CACnD,KAAM,CAAE,UAAA6B,CAAW,EAAG,MAAMtB,EAASH,CAA2B,EAEhE,GAAIF,EAAQC,GAAW0B,EACrBL,EAAS,KAAK,CACZ,SAAU,WACV,QAAS,4DACf,CAAK,EACDxB,EAAe,MAAM,QAAU,WAC1B,CACLA,EAAe,MAAM,QAAU,OAC/BE,GAAS,EACT,MAAM4B,EAAa,MAAMvB,EAASH,CAAkB,EACpDS,EAAWiB,CAAU,EACrBH,GACD,CACH,CAAC"}